## はじめに
テストが存在することの価値や運用のしやすさに目を向けている

## 本書の構成
1. なぜ、単体テストを行うのか？
2. 単体テストとは何か？
3. 単体テストの構造的解析
4. 良い単体テストを構成する4本の柱
5. モックの利用とテストの壊れやすさ
6. 単体テストの3つの手法
7. 単体テストの価値を高めるリファクタリング
8. なぜ、統合テストを行うのか？
9. モックのベスト・プラクティス
10. データベースに対するテスト
11. 単体テストのアンチ・パターン

## なぜ、単体テストを行うのか？
- 単体テストの現状
    - コードは成長と共に劣化する傾向がある。変更によって発生するバグを検出するためのセーフティネット
    - 単体テストの質が悪ければ、テストをまったくしない場合と同じ結果になる可能性がある
    - コードが成長してもバグが発生しないことに自信を持てるため成長を持続可能なものにしてくれる
    - 単にテストケースを増やすだけでは、単体テストの目標を実現できない。単体テストの価値と保守コストを考慮する必要がある。
- カバレッジとテスト・スイートの質との関係
    - カバレッジはテストスイートの質が悪いことを示せても、質が良いことを証明することはできないので、テストスイートの質を評価にカバレッジを利用することは不適切
    - カバレッジを数値で縛ると開発の妨げになることがあるため強要することは禁物
    - 確認（アサート）してなくても、実行されていればカバレッジは計測される（確認不在のテスト）
- テストスイートの適切な評価方法
    - すべてのテストケースは平等に作られておらず、質の高いテストケースだけを集めることが重要
    - テストスイートの質がいかに優れているのかを自動的に評価できるような方法は存在しない
    - テストスイートの質を良くする方法は存在する。優れたテストスイートには以下の特徴がある
        - テストすることが開発サイクルの中に組み込まれている
        - コードベースの特に重要な部分のみがテスト対象となっている
            - システムの核であるドメインロジックのテストが最も価値が高い
        - 最小限の保守コストで最大限の価値を生み出すようになっている
- **テストにおいて以下の2つが重要**
    - テストケースの質の善し悪しを区別できること
    - より価値をもたらすテストコードとなるようなリファクタリングを行えること

Q. インフラはどういう場合にテストするのが良いのか？
Q. 価値のあるテスト・ケースを認識するにはどうすれば良いのか？

## 単体テストとは何か？
- 単体テストとは何か？
    - 1単位の振る舞いを検証すること
    - 実行時間が短いこと
    - 他のテスト・ケースから隔離された状態で実行されること
- 共有依存、プライベート依存、揮発性依存の違い
- 単体テストにおける2つの学派である古典学派とロンドン学派について
    - ロンドン学派：依存は全てモックを使うことで一つのクラスに専念する
- 単体テスト、統合テスト、E2Eテストの違い


単体テストとは、ソフトウェア開発の中で、ある機能やメソッドなどの単一のユニットに対して、そのユニットが想定通りに動作するかどうかを確認するテストのこと。単体テストの特徴として「隔離された状態で実行される」というものが挙げられるが、この部分がロンドン学派と古典学派の大きく２つの思想に分かれる。
ロンドン学派は、テスト対象クラスの依存を全てテストダブルに置き換えることで、オブジェクトの準備が楽にな理、テスト失敗時にどこで問題が起こったかが明確にでき、テストスイートが簡潔になるメリットがある。
テストダブルとはテスト中に使用されるプログラムの代替実装を指します。テスト中に必要なオブジェクトの生成やデータの提供、エラーの発生などが含まれます。テストダブルには、スタブ、スパイ、フェイク、モックなどの種類があります。



## 単体テストの構造的解析
単体テストにおけるテスト・ケースの構造
テスト・メソッドに対する名前の付け方に関するベスト・プラクティス
パラメータ化テスト
確認フェーズの読みやすさの改善

## 良い単体テストを構成する4本の柱
良い単体テストを構成する性質の大きな分類
理想的なテストについての定義
テスト・ピラミッドについて
ブラック・ボックス・テストとホワイト・ボックス・テストの使い方

## モックの利用とテストの壊れやすさ
モックとスタブの違い
観察可能な振る舞いと実装の詳細の定義
モックの利用とテストの壊れやすさとの関係
リファクタリングへの耐性を損なわずにモックを使う方法

## 単体テストの3つの手法
単体テストの手法の比較
関数型アーキテクチャとヘキサゴナル・アーキテクチャとの関係
出力値ベース・テストへの移行

## 単体テストの価値を高めるリファクタリング
プロダクション・コードの種類の識別
質素なオブジェクトと呼ばれるパターンについて
価値のあるテスト・ケースを作成する方法

## なぜ、統合テストを行うのか？
統合テストの役割
テスト・ピラミッドについてのさらなる考察
価値のある統合テストの書き方

## モックのベスト・プラクティス
モックの価値を最大限に引き出す方法
モックからスパイへの移行
モックのベスト・プラクティス

## データベースに対するテスト
データベースをテストするのに必要な事前準備
データベースのテストに関するベスト・プラクティス
テスト・データのライフ・サイクル
テストでのデータベース・トランザクションの管理

## 単体テストのアンチ・パターン
プライベートなメソッドをテストすること
テストを行えるようにするために、プライベートな状態を公開すること
テストへのドメイン知識の漏洩
具象クラスに対するテスト・ダブルの作成
