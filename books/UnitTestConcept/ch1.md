## 単体テスト概要
単体テストとは、ソフトウェア開発の中で、ある機能やメソッドなどの単一のユニットに対して、そのユニットが想定通りに動作するかどうかを確認するテストのこと。

コードは成長と供に劣化するので、変更によって発生する多くの退行を検出するセーフティーネットとしての役割などがある。

単にテストケースを増やすだけでは、単体テストの目標を実現できない。単体テストの価値と保守コストを考慮する必要がある。

### 単体テストにおける隔離の考え方と宗派
単体テストは隔離の仕方で古典学派とロンドン学派の宗派が2つ存在する。
古典学派はテストケースを隔離しようとする一方で、ロンドン学派はテスト対象システムを依存オブジェクトから隔離しようとしている。古典学派は完全モック否定派ではなく、共有依存（DB、ファイルなどの一つのインスタンスを共有）している箇所はモックを利用する。

||隔離対象|単体の意味|テスト・ダブルの置き換え対象|
|:-|:-|:-|:-|
|ロンドン学派|単体|1つのクラス|不変依存を除く全ての依存|
|古典学派|テスト・ケース|1つのクラス、もしくは、同じ目的を達成するための1グループ|共有依存|

### 統合テストの考え方の違い
基本的に古典学派的な考えでいくと、DBなどのプロセス外依存を含めると統合テストになる。
自分の中でどこからが統合テストなのかわからなかった。複数の関数を利用するユースケース的な関数は統合テストになるのか？DBなどの外部依存が発生すると統合テストになるのか？
これは古典学派とロンドン学派の考え方が異なるためだなと思った。古典学派はテストケースを1単位と考える一方で、ロンドン学派は1クラス（メソッド）を1単位と考えるのでロンドン学派的には1関数のテストであっても、他の関数もテストしていたらそれは統合テストになるということ。

### テストコードにおけるAAA
テスト・ケースは 準備(Arrange)、実行(Act)、確認(Assert) の3つのフェーズで構成されるAAAパターンを適用して記述されるべき。そして単体テストなので、実行フェーズは一つであるべき。2つ異常実行処理がある場合は分割の余地あり。

準備フェーズでは、同じオブジェクトを準備したい場合があるのでその場合はテストフィクスチャを利用する。テストフィクスチャとはテストを実施する際に利用されるオブジェクトのことで、常に決められた状態になっていることが求められる。

### テスト関数の命名
関数の命名においては、自分はよく"Test関数名"のテストメソッドを作り、その中で複数のテストケースを記述している。理由としてはテストケースごとに関数を切ってると似たようなテストコードが量産されるため、関数名のテストの中でテストケースの配列をループで回して検証する手法を取ることで簡潔に記述している。

筆者的にはコードをテストしてるのではなくアプリケーションの振る舞いをテストしているのでテスト対象のメソッド名をテスト名に含めるべきではないという思想らしい。パラメータテストに関しては、テストケースの意図が伝わりにくいため正常系と異常系に分ける。（納得いってない）

例として、容積率を計算する関数なら、"Test関数"でパラメータテストするのが良いけど、ユースケースなど一連の流れや整合性が重要になってくる場面であれば"Test振る舞い"でも良いのかなと思った。また、正常系と異常系に分けるのも可読性の観点からも良さそう
ただ、自分の場合はユースケースはアプリケーション層に記載しており、関数名からユースケースを想像しやすいものにしているため、"Test関数名"でも違和感ない状態になっていると思う。



こうなると、テストケース = ユースケースなのか？
容積率の計算などは関数のテストになるのでロンドン学派的なテストになるのか？

メモ
- マイクロサービスはテストが統合テストが面倒（状態が揃ってないと落ちる）
